@using RTB.Blazor.Styled
@using RTB.Blazor.Styled.Helper

@inherits RTBStyleBase

@code {
    [Parameter, EditorRequired] public required RenderFragment ChildContent { get; set; }
    [Parameter] public string Query { get; set; } = string.Empty;

    private readonly StyleBuilder _builder = StyleBuilder.Start;
}

<CascadingValue Value="@_builder" IsFixed>
    @ChildContent
</CascadingValue>

@code {
    protected override StyleBuilder BuildStyle(StyleBuilder builder)
    {
        if (!_builder.IsDirty) return builder;

        var style = _builder.Build();
        return builder.AppendSelector(Query, style);
    }
}
